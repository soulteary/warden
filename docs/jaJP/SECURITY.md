# セキュリティドキュメント

> 🌐 **Language / 语言**: [English](../enUS/SECURITY.md) | [中文](../zhCN/SECURITY.md) | [Français](../frFR/SECURITY.md) | [Italiano](../itIT/SECURITY.md) | [日本語](SECURITY.md) | [Deutsch](../deDE/SECURITY.md) | [한국어](../koKR/SECURITY.md)

このドキュメントは、Warden のセキュリティ機能、セキュリティ設定、ベストプラクティスについて説明します。


## 実装されたセキュリティ機能

1. **API 認証**: 機密エンドポイントを保護するための API キー認証をサポート
2. **SSRF 保護**: サーバーサイドリクエスト偽造攻撃を防ぐために、リモート設定 URL を厳密に検証
3. **入力検証**: インジェクション攻撃を防ぐために、すべての入力パラメータを厳密に検証
4. **レート制限**: DDoS 攻撃を防ぐための IP ベースのレート制限
5. **TLS 検証**: 本番環境では TLS 証明書の検証を強制
6. **エラー処理**: 本番環境では情報漏洩を防ぐために詳細なエラー情報を非表示
7. **セキュリティレスポンスヘッダー**: セキュリティ関連の HTTP レスポンスヘッダーを自動的に追加
8. **IP ホワイトリスト**: ヘルスチェックエンドポイントの IP ホワイトリスト設定をサポート
9. **設定ファイルの検証**: パストラバーサル攻撃を防止
10. **JSON サイズ制限**: メモリ枯渇攻撃を防ぐために JSON レスポンスボディのサイズを制限

## セキュリティベストプラクティス

### 1. 本番環境の設定

**必須設定**:
- `API_KEY` 環境変数を設定する必要があります
- `MODE=production` を設定して本番モードを有効化
- `TRUSTED_PROXY_IPS` を設定してクライアント IP を正しく取得
- `HEALTH_CHECK_IP_WHITELIST` を使用してヘルスチェックアクセスを制限

### 2. 機密情報の管理

**推奨される方法**:
- ✅ 環境変数を使用してパスワードとキーを保存
- ✅ パスワードファイル（`REDIS_PASSWORD_FILE`）を使用して Redis パスワードを保存
- ✅ 設定ファイルでプレースホルダーまたはコメントを使用
- ✅ 設定ファイルの権限が正しく設定されていることを確認（例：`chmod 600`）

### 3. ネットワークセキュリティ

**必須設定**:
- 本番環境では HTTPS を使用する必要があります
- ファイアウォールルールを設定してアクセスを制限
- 既知の脆弱性を修正するために依存関係を定期的に更新

## API セキュリティ

### API キー認証

一部の API エンドポイントには API キー認証が必要です。

**認証方法**:
1. **X-API-Key ヘッダー**:
   ```http
   X-API-Key: your-secret-api-key
   ```

2. **Authorization Bearer ヘッダー**:
   ```http
   Authorization: Bearer your-secret-api-key
   ```

### レート制限

デフォルトでは、API リクエストはレート制限によって保護されています：
- **制限**: 1 分あたり 60 リクエスト
- **ウィンドウ**: 1 分
- **超過**: `429 Too Many Requests` を返す

## 脆弱性の報告

セキュリティの脆弱性を発見した場合は、以下を通じて報告してください：

1. **GitHub Security Advisory**（推奨）
   - リポジトリの [Security](https://github.com/soulteary/warden/security) タブに移動
   - "Report a vulnerability" をクリック
   - セキュリティアドバイザリフォームに入力

2. **メール**（GitHub Security Advisory が利用できない場合）
   - プロジェクトのメンテナーにメールを送信
   - 脆弱性の詳細な説明を含める

## 関連ドキュメント

- [設定ドキュメント](CONFIGURATION.md) - セキュリティ関連の設定オプションについて
- [デプロイメントドキュメント](DEPLOYMENT.md) - 本番環境のデプロイメント推奨事項について
- [API ドキュメント](API.md) - API セキュリティ機能について
